<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Global Life Expectancy & Healthcare — Storytelling Visualisation</title>

    <!-- Vega / Vega-Lite / Embed -->
    <script src="https://cdn.jsdelivr.net/npm/vega@5"></script>
    <script src="https://cdn.jsdelivr.net/npm/vega-lite@5"></script>
    <script src="https://cdn.jsdelivr.net/npm/vega-embed@6"></script>

    <!-- Typeface -->
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">

    <style>
        :root {
            --page-bg: linear-gradient(135deg, #f5f7fa 0%, #eef3f8 100%);
            --card-bg: #ffffff;
            --muted: #6c7a89;
            --accent: #2b8cbe;
            --accent2: #ffa94d;
            --maxWidth: 1100px;
        }

        html,
        body {
            height: 100%;
            margin: 0;
            padding: 0;
            background: var(--page-bg);
            font-family: "Poppins", system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif;
            color: #243746
        }

        .wrap {
            max-width: var(--maxWidth);
            margin: 28px auto;
            padding: 28px;
            background: var(--card-bg);
            border-radius: 12px;
            box-shadow: 0 18px 40px rgba(10, 25, 47, 0.08)
        }

        header {
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
            padding-bottom: 18px;
            border-bottom: 1px solid #eef2f5
        }

        h1 {
            font-size: 28px;
            margin: 6px 0 4px 0;
            color: #12324b
        }

        p.lead {
            color: var(--muted);
            max-width: 500px;
            line-height: 1.6;
            margin: 0 auto
        }

        .meta {
            margin-top: 12px;
            color: var(--muted);
            font-size: 0.9rem
        }

        .section {
            display: block;
            padding: 28px 0;
            border-bottom: 1px solid #f1f4f6
        }

        .viz-row {
            display: grid;
            grid-template-columns: 1fr;
            gap: 18px;
            align-items: start
        }

        @media(min-width:980px) {
            .viz-row {
                grid-template-columns: 1fr 1fr
            }
        }

        .viz-card {
            background: #fcfeff;
            border-radius: 10px;
            padding: 14px;
            box-shadow: 0 6px 18px rgba(10, 25, 47, 0.04)
        }

        /* FIX: Make visualization containers full width */
        .viz-card-full {
            background: #fcfeff;
            border-radius: 10px;
            padding: 14px;
            box-shadow: 0 6px 18px rgba(10, 25, 47, 0.04);
            width: 100%;
            box-sizing: border-box;
        }

        .viz-title {
            font-weight: 600;
            color: #173547;
            margin: 0 0 8px 0
        }

        .caption {
            color: var(--muted);
            font-size: 0.95rem;
            margin: 10px 0;
        }

        .note {
            background: #fff4e6;
            padding: 12px;
            border-left: 4px solid var(--accent2);
            border-radius: 6px;
            color: #5a3d18
        }

        footer {
            padding-top: 18px;
            text-align: center;
            color: var(--muted);
            font-size: 0.9rem
        }

        .two-col {
            display: grid;
            grid-template-columns: 1fr;
            gap: 18px
        }

        @media(min-width:980px) {
            .two-col {
                grid-template-columns: 2fr 1fr
            }
        }

        .annotation {
            font-size: 0.95rem;
            color: var(--muted);
            line-height: 1.6;
            max-width: 700px;
        }

        a {
            color: var(--accent)
        }
    </style>
</head>

<body>
    <div class="wrap">
        <header>
            <h1>Life & Health: Global Life Expectancy in Focus</h1>
            <p class="lead">A visual story exploring how health, vaccines, and economic factors shape life expectancy
                around the world.</p>
            <div class="meta">Data source: <a
                    href="https://www.kaggle.com/datasets/lashagoch/life-expectancy-who-updated" target="_blank">Kaggle
                    - Life Expectancy (WHO)</a> • Years covered: 2000–2015 • Last updated: <em>2015 snapshot focus</em>
            </div>
        </header>

        <!-- Section 1: Global Snapshot -->
        <section class="section">
            <div class="one-col">
                <div>
                    <h2 class="viz-title">Global Life Expectancy (2015)</h2>
                    <div class="viz-card-full" id="choropleth_map" style="min-height:520px"></div>
                    <p class="caption">A choropleth map showing life expectancy in 2015. Darker colors indicate longer
                        life expectancy. Hover a country to read its value.</p>

                    <div class="section-content">
                        <h3 style="margin-top:0">At a glance</h3>
                        <p>Life expectancy correlates with multiple factors including GDP, vaccination coverage, and
                            health indicators such as infant mortality and HIV incidence. Use this map to spot regions
                            with high and low life expectancy.</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- Section 2: Wealth-Health Trend -->
        <section class="section">
            <h2 class="viz-title">Wealth-Health Links</h2>
            <div class="one-col">
                <div class="viz-card-full" id="gdp_life_scatter" style="min-height:420px"></div>
            </div>
            <p class="caption">GDP per capita vs life
                expectancy (2000 - 2015) — bubble size shows population, while colour shows region. Notice the broad positive association: wealthier
                countries tend to have higher life expectancy, though there are exceptions.</p>
        </section>

        <!-- Section 3: Health factor relationships -->
        <section class="section">
            <h2 class="viz-title">Which health factors matter most?</h2>
            <div class>
                <div class="viz-card-full" id="health_matrix" style="min-height:200px"></div>
                <div class="viz-card-full" id="infant_dual" style="min-height:420px"></div>
            </div>
            <p class="caption">Top: Life expectancy against several health & social indicators — each small panel shows
                the relationship for a single factor. Bottom: infant deaths vs life expectancy for the 20 most populous
                countries — the bars and overlaid line let you compare the two measures.</p>
        </section>

        <!-- Section 4: Vaccines & Economics -->
        <section class="section">
            <h2 class="viz-title">Vaccination coverage and economic status</h2>
            <div class="viz-row">
                <div class="viz-card" id="vaccine_bar" style="min-height:420px"></div>
                <div class="viz-card" id="econ_box" style="min-height:420px"></div>
            </div>
            <p class="caption">Left: average economic coverage for Polio, Diphtheria and Hepatitis B (2015). Right:
                distribution of life expectancy for Developed vs Developing economies — boxplots reveal both median
                differences and within-group variability.</p>
        </section>

        <!-- Section 5: Population and global trend -->
        <section class="section">
            <h2 class="viz-title">Fertility vs Life Expectancy: The Development Divide</h2>
            <div class="one-col">
                <div class="viz-card-full" id="fertility_life_scatter" style="min-height:520px"></div>
                <!-- <div class="viz-card" id="global_trend" style="min-height:360px"></div> -->
            </div>
            <p class="caption">The scatterplot highlights effects of Fertility on Life Expectancy. Notice that lower Fertility rates
                lead to higher Life Expectancy — less offspring lead to more distributable resources. 
            </p>
        </section>

        <!-- Section 6: Change map
        <section class="section">
            <h2 class="viz-title">Where did life expectancy change most?</h2>
            <div class="viz-card" id="change_map" style="min-height:520px"></div>
            <p class="caption">A divergence map showing 2015 minus 2000 life expectancy. Blue areas show gains; red
                shades show relative declines or smaller gains. This helps identify regions that made the most progress
                and those left behind.</p>
        </section> -->

        <!-- Section 7: Conclusion & metadata -->
        <section class="section">
            <h2 class="viz-title">Key takeaways</h2>
            <div style="display:grid;gap:12px">
                <div class="viz-card annotation">
                    <ul>
                        <li><strong>Broad patterns:</strong> Higher GDP, better vaccine coverage, and lower infant
                            mortality are associated with higher life expectancy.</li>
                        <li><strong>Regional differences:</strong> Some regions show major improvements (2000→2015),
                            while others lag due to health crises or limited access to care.</li>
                        <li><strong>Population impact:</strong> A few large countries strongly influence the global
                            averages.</li>
                    </ul>
                </div>
                <div class="viz-card">
                    <h3 style="margin-top:0">Author & Metadata</h3>
                    <p class="meta">Author: <strong>Low Jhin Yen</strong> • Dataset: WHO life expectancy (Kaggle) •
                        Visualization toolkit: Vega-Lite • Date: 2015 (focus) • License/status: <a href="https://www.kaggle.com/datasets/lashagoch/life-expectancy-who-updated" target="_blank">Kaggle
                            - Life Expectancy (WHO)</a></p>
                </div>
            </div>
        </section>

        <footer>
            <p>Built with Vega-Lite • Hosted on GitHub Pages • Hover charts to explore details</p>
        </footer>
    </div>

    <!-- load the script that embeds the specs -->
    <script src="vega_lite_vis.js"></script>
</body>

</html>